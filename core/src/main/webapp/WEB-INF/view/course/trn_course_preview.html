<#include "../include/header.html">
<link rel="shortcut icon" href="http://fontawesome.io/assets/ico/favicon.ico">
<link rel="stylesheet" href="http://fontawesome.io/assets/css/site.css">
<link rel="stylesheet" href="http://fontawesome.io/assets/css/pygments.css">
<link rel="stylesheet" href="http://fontawesome.io/assets/font-awesome/css/font-awesome.css">
<script src="${base.contextPath}/clb/common/clbCode?courseSupplier=COURSE.SUPPLIER_ID" type="text/javascript"></script>
<script src="${base.contextPath}/clb/common/clbCode?productClass=PRD.PRODUCT_CLASS" type="text/javascript"></script>
<script src="${base.contextPath}/clb/common/clbCode?courseDuration=COURSE.CORUSE_DURATION" type="text/javascript"></script>
<script src="${base.contextPath}/clb/common/clbCode?pubCity=PUB.CITY" type="text/javascript"></script>
<script src="${base.contextPath}/clb/common/clbCode?coruseStatus=CORUSE.COURSE_STATUS" type="text/javascript"></script>

<script src="${base.contextPath}/clb/common/clbCode?courseType=CORUSE.COURSE_TYPE" type="text/javascript"></script>
<script src="${base.contextPath}/clb/common/clbCode?trainingMethod=COURSE.TRAINING_METHOD" type="text/javascript"></script>
<script src="${base.contextPath}/clb/common/clbCode?coruseBoutiqueVideo=CORUSE.BOUTIQUE_VIDEO" type="text/javascript"></script>
<script src="../lib/clb/js/clb.kendo.editor.js"></script>
<script type="text/javascript">
	courseEditor = '${RequestParameters.courseEditor!}';
	lecturerEditor = '${RequestParameters.lecturerEditor!}';
	console.log(courseEditor);
	console.log(lecturerEditor);
    var viewModelPreview = kendo.observable({
        model: {
        	courseId: '${RequestParameters.courseId!}',
        	topic: '${RequestParameters.topic!}',
        	courseDate: '${RequestParameters.courseDate!}',
        	duration: '${RequestParameters.duration!}',
        	type: '${RequestParameters.type!}',
        	trainingMethod: '${RequestParameters.trainingMethod!}',
        	supplierId: '${RequestParameters.supplierId!}',
        	prdDivision: '${RequestParameters.prdDivision!}',
        	prdClass: '${RequestParameters.prdClass!}',
        	lecturer:'${RequestParameters.lecturer!}',
        	price:'${RequestParameters.price!}',
        	city:'${RequestParameters.city!}',
        	address:'${RequestParameters.address!}',
        	password:'${RequestParameters.password!}',
        	appFlag:'${RequestParameters.appFlag!}',
        	wechatFlag:'${RequestParameters.wechatFlag!}',
        	pcFlag:'${RequestParameters.pcFlag!}',
        	boutiqueVideo:'${RequestParameters.boutiqueVideo!}',
        	boutiqueUrl:'${RequestParameters.boutiqueUrl!}',
        	courseEditor:'${RequestParameters.courseEditor!}',
        	lecturerEditor:'${RequestParameters.lecturerEditor!}'
        },
    });
    console.log(viewModelPreview.model);
    
  	//LINE ONLINE  	ALLLINE
  	var trainingMethod1 = viewModelPreview.model.trainingMethod;
  	var trainingMethodNew;
  	if(trainingMethod1){
  		if(trainingMethod == "LINE"){
  			trainingMethodNew = "线下";
  		}else if(trainingMethod == "ONLINE"){
  			trainingMethodNew = "线上";
  		}else{
  			trainingMethodNew = "线上及线下";
  		}
  	};
  	console.log(trainingMethodNew);
  	
  	var format = function(time, format){
	    var t = new Date(time);
	    var tf = function(i){return (i < 10 ? '0' : '') + i};
	    return format.replace(/yyyy|MM|dd|HH|mm|ss/g, function(a){
	        switch(a){
	            case 'yyyy':
	                return tf(t.getFullYear());
	                break;
	            case 'MM':
	                return tf(t.getMonth() + 1);
	                break;
	            case 'mm':
	                return tf(t.getMinutes());
	                break;
	            case 'dd':
	                return tf(t.getDate());
	                break;
	            case 'HH':
	                return tf(t.getHours());
	                break;
	            case 'ss':
	                return tf(t.getSeconds());
	                break;
	        }
	    })
	}
  	var courseDateNew;
  	if(viewModelPreview.model.courseDate && viewModelPreview.model.duration){
  		timeArr=viewModelPreview.model.courseDate.split(" ");
  		timeArr0=timeArr[0].split("-");
  		timeArr1=timeArr[1].split(":");
  		starttime = viewModelPreview.model.courseDate.replace(new RegExp("-","gm"),"/");
  		var starttimeHaoMiao = (new Date(starttime)).getTime();
  		duration = parseInt(viewModelPreview.model.duration)*60000;
  		var newTimeHaoMiao = new Date(starttimeHaoMiao+duration);
  		var newTime = format(newTimeHaoMiao, 'yyyy-MM-dd HH:mm:ss');
  		timeArrNew=newTime.split(" ");
  		timeArrNew1=timeArrNew[1].split(":");
  		courseDateNew = timeArr0[0]+"年"+timeArr0[1]+"月"+timeArr0[2]+"日"+" "+timeArr1[0]+":"+timeArr1[1]+" -"+timeArrNew1[0]+":"+timeArrNew1[1];
  		console.log(courseDateNew);
  	}
  	
</script>
<body>
<div id="dialog"></div>
<div id="page-content2">
	<div class="panel" style="padding: 0px;border:none;box-shadow: none;">
    	<div id="query-form2">
    		<form id="mainform2" class="form-horizontal" style="width: 80%;border:8px solid #DCDCDC;margin-left: 10%;margin-top: 30px">
                    <div class="panel-body" style="font-size: 15px;">
                        
                        <div style="margin-bottom: 7px;">
                            <div class="col-xs-9">
                                <div class="col-xs-12" style="margin-top: 20px">
	                                <div class="form-group">
	                                    <label id = "topic2" style="text-align: left;font-size: 40px;color: #000000" ></label>
	                                </div>
	                            </div>
                                <div class="col-xs-12" style="margin-top: 20px">
	                                <div class="form-group" >
	                                	<i class="fa fa-clock-o fa-2x"  aria-hidden="true" style="color: #FFDAB9"></i>
	                                    <label style="text-align: left">&nbsp课程时间：</label>
	                                    <label id = "courseDate2" style="text-align: left"></label>
	                                </div>
	                            </div>
                                <div class="col-xs-12" style="margin-top: 10px">
	                                <div class="form-group" >
	                                	<i class="fa fa-book fa-2x"  aria-hidden="true" style="color: #FFDAB9"></i>
	                                    <label style="text-align: left">&nbsp培训方式：</label>
	                                    <label id = "trainingMethod2" style="text-align: left"></label>
	                                </div>
	                            </div>
                                <div class="col-xs-12" style="margin-top: 10px">
	                                <div class="form-group" >
	                                	<i class="fa fa-user fa-2x"  aria-hidden="true" style="color: #FFDAB9"></i>&nbsp
	                                    <label style="text-align: left">&nbsp培训地址：</label>
	                                    <label id = "address2" style="text-align: left"></label>
	                                </div>
	                            </div>
                                <div class="col-xs-12" style="margin-top: 10px">
	                                <div class="form-group" >
	                                	<i class="fa fa-microphone fa-2x"  aria-hidden="true" style="color: #FFDAB9"></i>&nbsp&nbsp
	                                    <label style="text-align: left;background-color: #FFDAB9">&nbsp&nbsp&nbsp点我看课程&nbsp&nbsp&nbsp</label>
	                                    <label style="text-align: left"> &nbsp直播密码：</label>
	                                    <label id = "password2" style="text-align: left"></label>
	                                </div>
	                            </div>
                                <div class="col-xs-12" style="margin-botton: 20px">
	                                <div class="form-group" >
	                                    <label style="text-align: left;color: #C0C0C0">&nbsp&nbsp&nbsp&nbsp&nbsp温馨提示：仅签约渠道可查看精品视频及下载资料</label>
	                                </div>
	                            </div>
                            </div>
                            
                            
                            <div class="col-sm-3"  >
                           		<hr size=150 width="1" color="#999999">
                               	<div class="form-group" style="text-align: center">
                                    <label style="margin-top: 10px;font-size: 22px">￥0.00</label><br>
                                    <label style="margin-top: 10px;width:130px;background-color: #FFDAB9">查看报名信息</label>
                                </div>
                            </div>
                        </div>
                        
                        <HR style="FILTER: alpha(opacity=100,finishopacity=1,style=18);margin-top: 30px" width="100%" color=#D3D3D3 SIZE=18>
                        
                        <div class="col-sm-12" style="margin-bottom: 7px;margin-top: 10px">
                            <div class="form-group">
                                <label class="col-sm-12 control-label" style="text-align: left">课程简介</label>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-12">
                                	<!-- <label id="courseEditor" style="text-align: left;height: 150px;width: 100%"></label> -->
                                   	<textarea id="courseEditor2" type="text" style="width:100%;height:150px" readonly></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <HR style="FILTER: alpha(opacity=100,finishopacity=1,style=18);margin-top: 30px" width="100%" color=#D3D3D3 SIZE=18>
                        
                        <div class="col-sm-12" style="margin-bottom: 7px">
                            <div class="form-group">
                                <label class="col-sm-12 control-label" style="text-align: left">讲师简介</label>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-12">
                                	<!-- <label id="lecturerEditor" style="text-align: left;height: 150px;width: 100%"></label> -->
                                    <textarea id="lecturerEditor2" type="text" style="width:100%;height:150px;" readonly></textarea>
                                </div>
                            </div>
                        </div>
                            <script type="text/javascript">
                            	document.getElementById("topic2").innerText = viewModelPreview.model.topic;
                            	document.getElementById("courseDate2").innerText = courseDateNew;
                            	document.getElementById("trainingMethod2").innerText = trainingMethodNew;
                            	var address;
                            	if(!viewModelPreview.model.address){
                            		address = "无";
                            	}else{
                            		address = viewModelPreview.model.address;
                            	}
                            	var password;
                            	if(!viewModelPreview.model.password){
                            		password = "无";
                            	}else{
                            		password = viewModelPreview.model.password;
                            	}
                            	document.getElementById("address2").innerText = address;
                            	document.getElementById("password2").innerText = password;
                            	document.getElementById("courseEditor2").innerText = viewModelPreview.model.courseEditor;
                            	document.getElementById("lecturerEditor2").innerText = viewModelPreview.model.lecturerEditor;
                            </script>
                        <div class="col-sm-12" style="margin-bottom: 1px;">
                            <div class="form-group">
                                <span>&nbsp&nbsp&nbsp</span><a style="text-decoration:underline" href="javascript:void(0)" onclick="addAttachment2()">培训资料下载</a>
                            </div>
                            <div class="form-group" style="text-align: right">
                                <span class="btn btn-default" type="button" onclick="quxiaoyulan()">取消预览</span>
                            </div>
                        </div>
                    </div>
                </form>
    	</div>
    </div>
</div>
<script type="text/javascript">
	kendo.bind($('#page-content2'), viewModelPreview);
	
	function quxiaoyulan(){
		alert("dfgdf");
	}
	
	//附件下载
	var courseId = viewModelPreview.model.courseId;
	console.log(viewModelPreview.model.courseId);
	function addAttachment2(consultId) {
        var url = "trn_course_file.html?courseId="+courseId;
        var dialog = $("#dialog").kendoWindow({
            actions: ["Close"],
            height: "50%",
 	        width: "80%",
            title: '课程附件',
            content: url,
            iframe: true,
            visible: false,
            modal: true,
        }).data("kendoWindow");
        dialog.center().open();
    };
	
	 //富文本编辑器 
	$(document).ready(function() {
        /* $("#courseEditor2").kendoEditor({
            tools: [
            ],
        });
        $("#lecturerEditor2").kendoEditor({
            tools: [
            ],
        }); */
		 //使用自定义文本编辑器
		$.clbKendoEditor("courseEditor2");
		$.clbKendoEditor("lecturerEditor2");
		$.clbKendoUpload('<@spring.message "fms.pub.oss_web_path"/>','TRN',"${base.contextPath}/commons/attach/upload?${_csrf.parameterName}=${_csrf.token}");
	}); 
</script>
</body>
</html>